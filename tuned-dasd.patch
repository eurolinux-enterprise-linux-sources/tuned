From 1cc036e865088b1d88ac76d51a907334533a4f9e Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Jaroslav=20=C5=A0karvada?= <jskarvad@redhat.com>
Date: Mon, 9 Feb 2015 17:33:25 +0100
Subject: [PATCH] profiles: added support for direct-access storage devices
 (DASDs)
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

resolves: rhbz#1129936

Signed-off-by: Jaroslav Å karvada <jskarvad@redhat.com>
---
 ktune/README.ktune                                     | 2 +-
 ktune/ktune.sysconfig                                  | 2 +-
 tune-profiles/desktop-powersave/ktune.sysconfig        | 2 +-
 tune-profiles/enterprise-storage/ktune.sysconfig       | 2 +-
 tune-profiles/functions                                | 2 +-
 tune-profiles/laptop-ac-powersave/ktune.sysconfig      | 2 +-
 tune-profiles/laptop-battery-powersave/ktune.sysconfig | 2 +-
 tune-profiles/latency-performance/ktune.sysconfig      | 2 +-
 tune-profiles/sap-hana-vmware/ktune.sysconfig          | 2 +-
 tune-profiles/sap-hana/ktune.sysconfig                 | 2 +-
 tune-profiles/sap-netweaver/ktune.sysconfig            | 2 +-
 tune-profiles/server-powersave/ktune.sysconfig         | 2 +-
 tune-profiles/throughput-performance/ktune.sysconfig   | 2 +-
 tune-profiles/virtual-guest/ktune.sysconfig            | 2 +-
 tune-profiles/virtual-host/ktune.sysconfig             | 2 +-
 15 files changed, 15 insertions(+), 15 deletions(-)

diff --git a/ktune/README.ktune b/ktune/README.ktune
index b8a98bf..515653c 100644
--- a/ktune/README.ktune
+++ b/ktune/README.ktune
@@ -51,7 +51,7 @@ service is enabled and started, it will use the configuration options from
     SYSCTL_PRE="/etc/sysctl.conf /etc/sysctl.d/*"
     SYSCTL_POST="/etc/sysctl.conf /etc/sysctl.d/*"
     ELEVATOR="deadline"
-    ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss}*/queue/scheduler"
+    ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd,dasd}*/queue/scheduler"
 
 SYSCTL is the primary ktune sysctl profile. If you comment it out, it will not
 get applied.
diff --git a/ktune/ktune.sysconfig b/ktune/ktune.sysconfig
index c77f72c..d9b3dd6 100644
--- a/ktune/ktune.sysconfig
+++ b/ktune/ktune.sysconfig
@@ -24,4 +24,4 @@ SYSCTL_POST="/etc/sysctl.conf /etc/sysctl.d/*"
 ELEVATOR="deadline"
 
 # These are the devices, that should be tuned with the ELEVATOR
-ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss}*/queue/scheduler"
+ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd,dasd}*/queue/scheduler"
diff --git a/tune-profiles/desktop-powersave/ktune.sysconfig b/tune-profiles/desktop-powersave/ktune.sysconfig
index 3918908..faba34b 100644
--- a/tune-profiles/desktop-powersave/ktune.sysconfig
+++ b/tune-profiles/desktop-powersave/ktune.sysconfig
@@ -24,4 +24,4 @@ SYSCTL_POST="/etc/sysctl.conf /etc/sysctl.d/*"
 #ELEVATOR="deadline"
 
 # These are the devices, that should be tuned with the ELEVATOR
-#ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd}*/queue/scheduler"
+#ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd,dasd}*/queue/scheduler"
diff --git a/tune-profiles/enterprise-storage/ktune.sysconfig b/tune-profiles/enterprise-storage/ktune.sysconfig
index cb6b21c..0099450 100644
--- a/tune-profiles/enterprise-storage/ktune.sysconfig
+++ b/tune-profiles/enterprise-storage/ktune.sysconfig
@@ -24,4 +24,4 @@ SYSCTL_POST="/etc/sysctl.conf /etc/sysctl.d/*"
 ELEVATOR="deadline"
 
 # These are the devices, that should be tuned with the ELEVATOR
-ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd}*/queue/scheduler"
+ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd,dasd}*/queue/scheduler"
diff --git a/tune-profiles/functions b/tune-profiles/functions
index c7690a3..d2cafb6 100644
--- a/tune-profiles/functions
+++ b/tune-profiles/functions
@@ -8,7 +8,7 @@
 #
 
 DISKS_DEV="$(command ls -d1 /dev/[shv]d*[a-z] 2>/dev/null)"
-DISKS_SYS="$(command ls -d1 /sys/block/{sd,cciss,dm-,vd}* 2>/dev/null)"
+DISKS_SYS="$(command ls -d1 /sys/block/{sd,cciss,dm-,vd,dasd}* 2>/dev/null)"
 
 # SATA Aggressive Link Power Management
 # usage: set_disk_alpm policy
diff --git a/tune-profiles/laptop-ac-powersave/ktune.sysconfig b/tune-profiles/laptop-ac-powersave/ktune.sysconfig
index 3918908..faba34b 100644
--- a/tune-profiles/laptop-ac-powersave/ktune.sysconfig
+++ b/tune-profiles/laptop-ac-powersave/ktune.sysconfig
@@ -24,4 +24,4 @@ SYSCTL_POST="/etc/sysctl.conf /etc/sysctl.d/*"
 #ELEVATOR="deadline"
 
 # These are the devices, that should be tuned with the ELEVATOR
-#ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd}*/queue/scheduler"
+#ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd,dasd}*/queue/scheduler"
diff --git a/tune-profiles/laptop-battery-powersave/ktune.sysconfig b/tune-profiles/laptop-battery-powersave/ktune.sysconfig
index 3918908..faba34b 100644
--- a/tune-profiles/laptop-battery-powersave/ktune.sysconfig
+++ b/tune-profiles/laptop-battery-powersave/ktune.sysconfig
@@ -24,4 +24,4 @@ SYSCTL_POST="/etc/sysctl.conf /etc/sysctl.d/*"
 #ELEVATOR="deadline"
 
 # These are the devices, that should be tuned with the ELEVATOR
-#ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd}*/queue/scheduler"
+#ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd,dasd}*/queue/scheduler"
diff --git a/tune-profiles/latency-performance/ktune.sysconfig b/tune-profiles/latency-performance/ktune.sysconfig
index cb6b21c..0099450 100644
--- a/tune-profiles/latency-performance/ktune.sysconfig
+++ b/tune-profiles/latency-performance/ktune.sysconfig
@@ -24,4 +24,4 @@ SYSCTL_POST="/etc/sysctl.conf /etc/sysctl.d/*"
 ELEVATOR="deadline"
 
 # These are the devices, that should be tuned with the ELEVATOR
-ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd}*/queue/scheduler"
+ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd,dasd}*/queue/scheduler"
diff --git a/tune-profiles/sap-hana-vmware/ktune.sysconfig b/tune-profiles/sap-hana-vmware/ktune.sysconfig
index 8a16460..2143a7b 100644
--- a/tune-profiles/sap-hana-vmware/ktune.sysconfig
+++ b/tune-profiles/sap-hana-vmware/ktune.sysconfig
@@ -24,4 +24,4 @@ SYSCTL_POST="/etc/sysctl.conf /etc/sysctl.d/*"
 ELEVATOR="noop"
 
 # These are the devices, that should be tuned with the ELEVATOR
-ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd}*/queue/scheduler"
+ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd,dasd}*/queue/scheduler"
diff --git a/tune-profiles/sap-hana/ktune.sysconfig b/tune-profiles/sap-hana/ktune.sysconfig
index ce49d08..5248eec 100644
--- a/tune-profiles/sap-hana/ktune.sysconfig
+++ b/tune-profiles/sap-hana/ktune.sysconfig
@@ -27,4 +27,4 @@ SYSCTL_POST="/etc/sysctl.conf /etc/sysctl.d/*"
 ELEVATOR="deadline"
 
 # These are the devices, that should be tuned with the ELEVATOR
-ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd}*/queue/scheduler"
+ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd,dasd}*/queue/scheduler"
diff --git a/tune-profiles/sap-netweaver/ktune.sysconfig b/tune-profiles/sap-netweaver/ktune.sysconfig
index 2430ab1..386df8d 100644
--- a/tune-profiles/sap-netweaver/ktune.sysconfig
+++ b/tune-profiles/sap-netweaver/ktune.sysconfig
@@ -28,7 +28,7 @@ SYSCTL_PRE="/etc/sysctl.d/* /etc/sysctl.conf"
 ELEVATOR="deadline"
 
 # These are the devices, that should be tuned with the ELEVATOR
-ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd}*/queue/scheduler"
+ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd,dasd}*/queue/scheduler"
 
 # The following lines are for autodetection of SAP settings
 SAP_MAIN_MEMORY_TOTAL=`awk '/MemTotal:/ {print $2}' /proc/meminfo`
diff --git a/tune-profiles/server-powersave/ktune.sysconfig b/tune-profiles/server-powersave/ktune.sysconfig
index 3918908..faba34b 100644
--- a/tune-profiles/server-powersave/ktune.sysconfig
+++ b/tune-profiles/server-powersave/ktune.sysconfig
@@ -24,4 +24,4 @@ SYSCTL_POST="/etc/sysctl.conf /etc/sysctl.d/*"
 #ELEVATOR="deadline"
 
 # These are the devices, that should be tuned with the ELEVATOR
-#ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd}*/queue/scheduler"
+#ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd,dasd}*/queue/scheduler"
diff --git a/tune-profiles/throughput-performance/ktune.sysconfig b/tune-profiles/throughput-performance/ktune.sysconfig
index cb6b21c..0099450 100644
--- a/tune-profiles/throughput-performance/ktune.sysconfig
+++ b/tune-profiles/throughput-performance/ktune.sysconfig
@@ -24,4 +24,4 @@ SYSCTL_POST="/etc/sysctl.conf /etc/sysctl.d/*"
 ELEVATOR="deadline"
 
 # These are the devices, that should be tuned with the ELEVATOR
-ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd}*/queue/scheduler"
+ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd,dasd}*/queue/scheduler"
diff --git a/tune-profiles/virtual-guest/ktune.sysconfig b/tune-profiles/virtual-guest/ktune.sysconfig
index cb6b21c..0099450 100644
--- a/tune-profiles/virtual-guest/ktune.sysconfig
+++ b/tune-profiles/virtual-guest/ktune.sysconfig
@@ -24,4 +24,4 @@ SYSCTL_POST="/etc/sysctl.conf /etc/sysctl.d/*"
 ELEVATOR="deadline"
 
 # These are the devices, that should be tuned with the ELEVATOR
-ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd}*/queue/scheduler"
+ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,vd,dasd}*/queue/scheduler"
diff --git a/tune-profiles/virtual-host/ktune.sysconfig b/tune-profiles/virtual-host/ktune.sysconfig
index 897f130..a46ecfd 100644
--- a/tune-profiles/virtual-host/ktune.sysconfig
+++ b/tune-profiles/virtual-host/ktune.sysconfig
@@ -24,4 +24,4 @@ SYSCTL_POST="/etc/sysctl.conf /etc/sysctl.d/*"
 ELEVATOR="deadline"
 
 # These are the devices, that should be tuned with the ELEVATOR
-ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-}*/queue/scheduler"
+ELEVATOR_TUNE_DEVS="/sys/block/{sd,cciss,dm-,dasd}*/queue/scheduler"
-- 
2.1.0

